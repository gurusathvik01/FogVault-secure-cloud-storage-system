{% extends "admin-base.html" %}
{% block title %}Admin — Audit Timeline{% endblock %}

{% block content %}

<h2>Admin Audit Timeline</h2>
<p style="color:#64748b">
  Complete activity history for monitoring
</p>

<!-- FILTER FORM -->
<form method="get" style="margin:20px 0; display:flex; gap:10px; flex-wrap:wrap">

  <select name="user">
    <option value="">All Users</option>
    {% for u in users %}
      <option value="{{ u.id }}">{{ u.username }}</option>
    {% endfor %}
  </select>

  <select name="action">
    <option value="">All Actions</option>
    <option value="UPLOAD">Upload</option>
    <option value="DELETE">Delete</option>
    <option value="LOGIN">Login</option>
    <option value="LOGOUT">Logout</option>
  </select>

  <input type="date" name="start">
  <input type="date" name="end">

  <button type="submit">Filter</button>

</form>

<!-- AUDIT TABLE -->
<table style="width:100%; border-collapse:collapse">
  <thead>
    <tr style="border-bottom:1px solid #334155">
      <th>User</th>
      <th>Action</th>
      <th>File</th>
      <th>IP</th>
      <th>Date & Time</th>
    </tr>
  </thead>
  <tbody>
    {% for log in logs %}
    <tr style="border-bottom:1px solid #1e293b">
      <td>{{ log.user.username }}</td>
      <td>{{ log.action }}</td>
      <td>{{ log.file.filename|default:"—" }}</td>
      <td>{{ log.ip_address|default:"—" }}</td>
      <td>{{ log.timestamp }}</td>
    </tr>
    {% empty %}
    <tr>
      <td colspan="5" style="text-align:center; padding:20px">
        No logs found
      </td>
    </tr>
    {% endfor %}
  </tbody>
</table>

{% endblock %}
